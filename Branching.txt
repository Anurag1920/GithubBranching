some changes from branch 1. twice by arpit